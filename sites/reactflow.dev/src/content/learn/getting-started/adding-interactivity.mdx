---
description: This guide will show you how to add basic interactivity to your flow.
---

import { Callout } from 'nextra/components';
import { RemoteCodeViewer } from 'xy-shared/server';

In the following part we will introduce you to the core concepts of React Flow and explain how to create an interactive flow. A flow consists of nodes and edges (or just nodes). You can pass arrays of `nodes` and `edges` as props to the ReactFlow component. Hereby all node and edge ids need to be unique. A node needs a position and a label (this could be different if you are using [custom nodes](/learn/customization/custom-nodes)) and an edge needs a source (node id) and a target (node id). You can read more about the options in the [Node options](/api-reference/types/node) and [Edge options](/api-reference/types/edge) sections.

## Controlled or Uncontrolled

With React Flow you have two ways to setup a flow. You can either create a controlled or an [uncontrolled one](/learn/advanced-use/uncontrolled-flow).
We recommend to use a controlled one but for simpler use cases you can also setup an uncontrolled flow. **In the following part we will setup a controlled flow.** Let's start by adding some nodes and edges to the ReactFlow component:

<Callout type="warning">
  The dimensions of your React Flow component depend on the parent dimensions. That means
  that the parent needs a width and height to render React Flow properly.
</Callout>

<RemoteCodeViewer route="learn/introduction-flow" framework="react" />

## Basic Functionality

By default React Flow doesn't do any internal state updates besides handling the viewport when you setup a controlled flow. As with an `<input />` component you need to pass handlers to apply the changes that are triggered by React Flow to your nodes and edges. In order to **select**, **drag** and **remove** nodes and edges you need to implement an `onNodesChange` and an `onEdgesChange` handler:

<RemoteCodeViewer route="learn/introduction-flow-2" framework="react" />

What is happening here? Whenever React Flow triggers a change (node init, node drag, edge select, etc.), the `onNodesChange` handler gets called. We export an `applyNodeChanges` handler so that you don't need to handle the changes by yourself. The `applyNodeChanges` handler returns an updated array of nodes that is your new nodes array. You now have an interactive flow with the following kinds of interactions:

- selectable nodes and edges
- draggable nodes
- removable nodes and edges - (press Backspace to remove a selected node or edge, can be adjusted with the `deleteKeyCode` prop)
- multi-selection area by pressing Shift (that's the default `selectionKeyCode`)
- multi-selection by pressing command (that's the default `multiSelectionKeyCode`)

For convenience we export the helper hooks `useNodesState` and `useEdgesState` that you can use to create the nodes and edges state:

```js
const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);
const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);
```

## Connecting Nodes

The last piece that is missing to get the full interactivity is the `onConnect` handler. You need to implement it, in order to handle new connections.

<RemoteCodeViewer route="learn/introduction-flow-3" framework="react" />

In this example we are using the `addEdge` handler that returns an array of edges with the newly created one. If you want to set a certain edge option whenever an edge gets created you pass your options like this:

```js
const onConnect = useCallback(
  (connection) => setEdges((eds) => addEdge({ ...connection, animated: true }, eds)),
  [setEdges],
);
```

or use the `defaultEdgeOptions` prop:

```jsx
const defaultEdgeOptions = { animated: true };
...
<ReactFlow
  nodes={nodes}
  edges={edges}
  onNodesChange={onNodesChange}
  onEdgesChange={onEdgesChange}
  onConnect={onConnect}
  defaultEdgeOptions={defaultEdgeOptions}
/>;
```

# Adding Interactivity

Now that we've built our first flow, let's add interactivity so you can select, drag, and remove nodes and edges.

<Callout type="info">
  In this Getting Started tutorial, we'll use React Flow as a ["controlled
  component"](https://reactjs.org/docs/forms.html#controlled-components). This is
  typically the most flexible and reliable approach for integrating it into your
  applications. (If you prefer, you can also work with React Flow in an [uncontrolled
  way](/docs/guides/uncontrolled-flow/).
</Callout>

## Handling Change Events

Continuing from [Building a Flow]('/learn/getting-started/building-a-flow), letâ€™s dive into some essentials. To manage changes, we'll be using `useState` with two helper functions from React Flow: `applyEdgeChanges` and `applyNodeChanges`. We can import these into our project like this:

```js
import { useState, useCallback } from 'react';
import { ReactFlow, applyEdgeChanges, applyNodeChanges } from '@xyflow/react';
```

Next, we're going to set up states for both the nodes and edges:

```js
const [nodes, setNodes] = useState(initialNodes);
const [edges, setEdges] = useState(initialEdges);
```

Directly beneath that, we'll add these two functions:

```js
const onNodesChange = useCallback(
  (changes) => setNodes((nds) => applyNodeChanges(changes, nds)),
  [],
);
const onEdgesChange = useCallback(
  (changes) => setEdges((eds) => applyEdgeChanges(changes, eds)),
  [],
);
```

When you drag or select a node, the `onNodesChange` handler is triggered. The `applyNodeChanges` function then uses these change events to update the current state of your nodes. Here's how it all comes together. Try clicking and dragging a node to move it around and watch the UI update in real time.

<RemoteCodeViewer route="learn/make-it-interactive-1" framework="react" />

## Handle Connections

One last piece is missing: connecting nodes manually. For this, we need to implement an `onConnect` handler and pass it to the `<ReactFlow />` component:

<RemoteCodeViewer route="learn/make-it-interactive-2" framework="react" />

Try to connect the two nodes by dragging from on handle to another one. That's it. You've built a fully interactive flow.

That's it for now :) You made it! If you want to move on, we recommend to check out the ["Custom Nodes" guide](/learn/customization/custom-nodes).
